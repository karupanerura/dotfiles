#!/bin/sh
set -e
# set -x

IN_TREE=`git rev-parse --is-inside-work-tree`;
if [ "$IN_TREE" = "true" ]; then
    GITROOT=`git rev-parse --show-toplevel`
    LOGFILE=$GITROOT/.git/info/.branch.log
    git branch-name >> $LOGFILE
    tail -n 100 $LOGFILE | uniq > $LOGFILE.tmp
    mv $LOGFILE.tmp $LOGFILE
fi
